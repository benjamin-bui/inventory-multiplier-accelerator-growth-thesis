\section{Model Set-Up}
Metzler's and Wegener's model show that it is possible for endogenous business cycles to be induced through inventory cycles and the failure of firms to accurately predict future consumption. These models were designed to focus on the effects of firm expectations with Wegener's contribution consisting of introducing a heterogenous expectation rule that allows firms to switch behavior based on the state of the economy. Both of these models however simplify other aspects of the economy that feature more complex behavior in other business cycle models.

The inventory cycle model features 3 main factors of production: predicted consumption, investment, and inventory. Metzler and Wegener holds investment as an exogenously determined constant; however, this is both unrealistic and does not allow for long term endogenous growth. To incorporate a mechanism for endogenously adjusting investment, we take inspiration from the multiplier-accelerator model presented in Chapter \ref{ch:multiplier-accelerator}. 

The problem with the cubic investment function used in that model is that it leads to unbounded behavior in the extremes, much like the linear function. Puu resolves this by ensuring that income growth is bounded by [-1, 1] but this is not the case for our model. We instead want a function that features similar curvature and behavior as the cubic function over moderate values but flattens when income change is of significant magnitude. This can be accomplished with the following function:
\begin{equation}
    I_t = \frac{\frac{Y_{t-1}-Y_{t-2}}{v}}{(\frac{Y_{t-1}-Y_{t-2}}{v})^4+q}	
\end{equation}
This function gives the backbending behavior of the cubic function without the exploding results.
\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/investment.eps}
    \caption{Plot of investment curve when $v=500$ and $q=0.001$.}
    \label{metzlerian_growth-investment}
\end{figure}

The behavior of this function qualitatively resembles that of the linear-cubic function described in by Puu when $v,q>0$; however, $\lim_{(Y_{t-1}-Y_{t-2})\to\infty}I_t=0$. This function is at its absolute maximum and minimum when:
\begin{equation*}
    Y_{t-1}-Y_{t-2}=\pm\frac{q^{1/4}v}{3^{1/4}}
\end{equation*}
Thus giving a maximal or minimal investment of:
\begin{equation*}
    I_t=\frac{3^{3/4}}{4q^{3/4}}
\end{equation*}
\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/maxinvestment.eps}
    \caption{Plot of maximal investment as $q$ varies between 0 and 2000.}
    \label{metzlerian_growth-maxinvestment}
\end{figure}
Intuitively, larger values of $v$ make the function "wider", increasing the range over $Y_{t-1}-Y_{t-2}$ where $I_t$ is not effectively 0. Smaller values of $q$ increases the magnitude of the maximum and minimum of the function, effectively making it taller. $v$ and $q$ cannot be directly attributed to any direct economic phenomena; however, their effect on the function can be interpreted analogously to the properties of the linear-cubic function. The "height" of the function determines the potential magnitude of investment and the "width" determines the rate at which investment, both private and public, react to changes in income.
\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/widthinvestment.eps}
    \caption{Plot of the full width at half maximum (FWHM) of the investment curve as $v$ varies between 1 and 2000 and $q$ varies between 0.001 and 0.002}
    \label{metzlerian_growth-widthinvestment}
\end{figure}
Fig \ref{metzlerian_growth-widthinvestment} shows that the FWHM of the investment curve has a nearly positive, linear relationship with both $v$ and $q$ over tested values of $v$ and $q$.

Metzler describes the existence of two important lags in the study of Keynesian models. The Robertson lag is characterized by making current consumption a function of past income, i.e. consumption behavior lags behind current income. The Lundberg lag however concerns a discrepancy between the income level and the production decision of firms\autocite{Metzler1941}. These lags are named after the two economists D. H. Robertson and Erik Lundberg who developed models that contained only their eponymous lag type. Although both lags are likely to exist in reality, most models only incorporate one lag due to the increased complexity associated with it. Metzler and Wegener make use of a Lundberg lag by making income a function of the predicted level of consumption as opposed to actual consumption. T\"{o}nu Puu's model makes use of a Robertson lag in order to induce endogenous business cycles. Metzler himself does not claim that the Lundberg sequence is any more realistic than the Robertson sequence. Whichever lag has a longer time-period can be treated as of being greater importance but Metzler actually proposes a variety of scenarios that present contradicting conclusions. Suppose that firms decided their behavior on a quarterly basis but consumers altered their spending behavior with every paycheck, then it would be appropriate to treat the Robertson lag as being of 0 length, i.e. nonexistent. If consumers revise their spending behavior every 6 months to a year, then it would actually be more realistic to include a non-zero Robertson lag while minimizing the Lundberg lag. 

For the purposes of this model, we will include a non-zero Lundberg and Robertson lag. The consumption function is treated exactly as presented in Puu:
\begin{equation}
    C_t=(1-s)Y_{t-1}+sY_{t-2}
\end{equation}

As the economy is also making use of a Robertson lag, income is not directly a function of consumption as it is \ref{ch:multiplier-accelerator}. Rather, income is viewed from a production standpoint. This is achieved by explicitly defining a predicted level of consumption. Wegener and Metzler use an equation similar to the form:

\begin{equation*} 
    U_t=C_{t-1}+\eta(C_{t-1}-C_{t-2})
\end{equation*}
However, this assumes that firms have no way to adapt their coefficient of expectation $\eta$. 

A new predictive mechanism requires that firms have bounded rationality. If firms possessed perfect rationality, then they would be able to perfectly predict consumption levels as consumption is based on lagged income, thus if we wish to maintain our Robertson lag, firms must still have bounded rationality. Another mechanism that firms can use that maintains better "memory" is that of an average. 
\begin{equation}\label{predict}
    U_t = \frac{C_{t-1}+C_{t-2}+C_{t-3}}{3}
\end{equation}
This formulation is an average of the consumption levels of the past 3 time periods. The choice of three time periods is relatively arbitrary and higher order difference equations of the same form can be used; however these higher order formulations can result in a less mathematically tractable model.

Inventory production proceeds as seen in Chapter 2 with firms producing $S_t$ explicitly to maintain inventory at optimal levels:
\begin{equation}
    S_t = k U_t-Q_{t-1}
\end{equation}
where $Q_t$ is the level of inventory maintained at the end of time $t$ and $k\in[0,1]$. This can be solved for as the sum of the previous inventory level, production intended for inventory, and the difference between production intended for consumption and the actual consumption level:
\begin{equation}
    Q_t=Q_{t-1}+S_t+(U_t-C_t)
\end{equation}

Income level, or output, can thus be written as a sum of production:
\begin{equation}\label{eq:Income}
    Y_t=I_t+S_t+U_t
\end{equation}
However, as income has the capability of sustained growth under this model, it is preferable to analyze the rate of change of income in this model. In Appendix \ref{appendix_growth}, we show that the growth rate of the economy can be interpreted as a single variable, 6th order difference equation on $\dot Y$:
\begin{equation}
    \begin{split}
        \dot Y_{t}& = \frac{\frac{\dot Y_{t-1}}{v}}{\left(\frac{\dot Y_{t-1}}{v}\right)^4+q}-\frac{\frac{\dot Y_{t-2}}{v}}{\left(\frac{\dot Y_{t-2}}{v}\right)^4+q} + \\
        & \frac{k+1}{3}\left[(1-s)(\dot Y_{t-2}-Y_{t-5})+s(\dot Y_{t-3}-Y_{t-6})\right]+(1-s)\dot Y_{t-2}+s\dot Y_{t-3}
    \end{split}
    \end{equation}

\section{Growth Dynamics}
The long run dynamics of the model are highly dependent on the choice of initial conditions. Simulation of the model require a choice of 6 initial values of income change in addition to the parameter choice. If the 6 initial values are equivalent, all future iterations of the mapping are equal to this choice and the model remains in a stable steady state. It is both more interesting and realistic then, to consider cases where there is variation in initial income growth.
\begin{figure}[ht]
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/timeseries1.eps}
    \caption{Timeseries plot of income growth rate over 150 iterations. $s=0.6,\ k=0.3,\ v=500,\ q=0.001$. Initial values of $\dot Y$ are: 100, 120, 110, 100, 105, 107}
    \label{metzlerian_growth-timeseries1}
\end{figure}
Figure \ref{metzlerian_growth-timeseries1} displays a possible trajectory of income growth. Under the parameters listed, the trajectory clearly behaves in a stable, cyclic manner within 40 iterations. 

There do not exist techniques to solve generalized 6th order difference equations; however it is possible to computationally solve for the long run dynamics of the system.
\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/sbifurcation}
    \caption{Bifurcation diagram varying $s$ between 0.1 and 0.9. Initial conditions and other parameters are held constant as described in Figure \ref{metzlerian_growth-timeseries1}.}
    \label{metzlerian_growth-sbifurcation}
\end{figure} The bifurcation diagram displayed in Figure \ref{metzlerian_growth-sbifurcation} displays the long-run behavior of the model as $s$ is varied. The methodology of the computational analysis of the bifurcation points and the results of this analyis are displayed in detail in Section \ref{bifurcation_analyzer} and Section \ref{bifurcation_analysis}, respectively. Long-run values are rounded to their nearest whole number for the purposes of this computational analysis although it is possible to account for higher levels of numerical precision using the analyzer. The mapping displays a stable 2-cycle when $s\in(0.65, 0.53)$. This implies the presence of a stable business cycle when the marginal propensity to save is moderately high; however, the behavior appears chaotic when the marginal propensity to save approaches either extreme. 

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/kbifurcation}
    \caption{Bifurcation diagram varying $k$ between 0.1 and 0.9. Initial conditions and other parameters are held constant as described in Figure \ref{metzlerian_growth-timeseries1}.}
    \label{metzlerian_growth-kbifurcation}
\end{figure}

The bifurcation diagram varying $k$ seen in Figure \ref{metzlerian_growth-kbifurcation} qualitatively appears much simpler than Figure \ref{metzlerian_growth-sbifurcation}. This diagram displays a bifurcation point when $k\approx 0.84837$. The model displays stable 2-cycle behavior until this point although the system continues to display windows of ordered cycles. It thus appears that although increasing the desired proportional level of inventory does increase the long-run level of cyclic growth, it does not affect the topology until $k$ is unrealistically large. 

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/vbifurcation}
    \caption{Bifurcation diagram varying $v$ between 1 and 2000. Initial conditions and other parameters are held constant as described in Figure \ref{metzlerian_growth-timeseries1}.}
    \label{metzlerian_growth-vbifurcation}
\end{figure}
\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/qbifurcation}
    \caption{Bifurcation diagram varying $q$ between 0 and 0.0001. Initial conditions and other parameters are held constant as described in Figure \ref{metzlerian_growth-timeseries1}.}
    \label{metzlerian_growth-qbifurcation}
\end{figure}

Figure \ref{metzlerian_growth-vbifurcation} exhibits stable, fixed growth when $v\in(1,297.338)\cup(617.104, 2000)$ which is the upper bound of what was computationally determined. The model also displays a stable 2-cycle when $v\in(472.173, 589.757)$. Likewise, Figure \ref{metzlerian_growth-qbifurcation} has a bifurcation point at $q\approx0.0015997$ and $q\approx0.0015976$ which mark transitions from a stable, fixed point to a 2-period cycle to a 3-period cycle (more bifurcation points exist within the diagram and are more easily viewed by narrowing the parameter variation range, this can be seen in Figure \ref{metzlerian_growth-qbifurcation_zoom}). As stated previously, $v$ and $q$ individually lack an economic interpretation, but together they approximate the dynamics of a linear-cubic investment curve while incorporating bounded, asymptotic behavior. 

These bifurcation diagrams do not tell the complete story of this model however for any given set of parameters. As stated previously, the choice of constant initial conditions will result in a constant trajectory of income growth. However, it is also trivial to show the existence of other trajectories by creating a timeseries holding the parameters constant but shifting the initial conditions.
\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/timeseries3}
    \caption{Timeseries plot of income growth rate over 150 iterations. Parameter choice is identical to that of Figure \ref{metzlerian_growth-timeseries1}. Initial values of $\dot Y$ are: 29, 20 , 15 , 10, 20 ,50,}
    \label{metzlerian_growth_timeseries3}
\end{figure}

The timeseries displayed in Figure \ref{metzlerian_growth-timeseries1} and Figure \ref{metzlerian_growth_timeseries3} share the same parametrization but they clearly display distinct dynamics and are centered around different growth rates. It can be helpful to think of each initial value as a parameter for the purposes of analysis, thereby allowing us to create bifurcation diagrams in order to identify their effects on the long-run behavior of the model.

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/y0bifurcation}
    \caption{Bifurcation diagram varying $\dot Y_0$ between -400 and 400. All other parameters and initial conditions kept as described in Figure \ref{metzlerian_growth-timeseries1}}
    \label{metzlerian_growth-y0bifurcation}
\end{figure}

This diagram shows several clearly defined regions of stable, ordered behavior. There is a bifurcation when $Y_0\approx -267.986$ that causes the dynamics of the mapping to shift away from fixed, stable growth. There is also a region where stable 2-cycles exist when $Y_0\in(-180.378, 231.903)$ before the emergence of higher order cycles. 

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/y1bifurcation}
    \caption{Bifurcation diagram varying $\dot Y_1$ between -400 and 400. All other parameters and initial conditions kept as described in Figure \ref{metzlerian_growth-timeseries1}}
    \label{metzlerian_growth-y1bifurcation}
\end{figure}

Figure \ref{metzlerian_growth-y1bifurcation} is also relatively simple to analyze, featuring a fixed growth rate until the bifurcation point where $Y_1\approx -99.010$. A region of stable 2-cycles also exist when $Y_1\in(-48.205,220.542)$. Fixed growth recommences when $Y_1\approx 243.104$ before shifting back into a 2-cycle region when $Y_1\approx 313.351$. 

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/y2bifurcation}
    \caption{Bifurcation diagram varying $\dot Y_2$ between -400 and 400. All other parameters and initial conditions kept as described in Figure \ref{metzlerian_growth-timeseries1}}
    \label{metzlerian_growth-y2bifurcation}
\end{figure}

Figure \ref{metzlerian_growth-y2bifurcation} is qualitatively almost identical to the diagram displayed in Figure \ref{metzlerian_growth-y1bifurcation}. The model displays fixed growth until the bifurcation point when $Y_2\approx -109.011$. A region of stable 2-cycles exists when $Y_2\in(-58.206, 210.541)$. Fixed growth recommences after the bifurcation point when $Y_2\approx 233.103$ before shifting back into stable 2-cycles when $Y_2\approx 303.350$. 

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/y3bifurcation}
    \caption{Bifurcation diagram varying $\dot Y_3$ between -400 and 400. All other parameters and initial conditions kept as described in Figure \ref{metzlerian_growth-timeseries1}}
    \label{metzlerian_growth-y3bifurcation}
\end{figure}

Figure \ref{metzlerian_growth-y3bifurcation} possess many regions of clearly visible, ordered cyclic behavior, of note however is presence of stable 2-cycles when $Y_3\in (19.162, 270.867)$.

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/y4bifurcation}
    \caption{Bifurcation diagram varying $\dot Y_4$ between -400 and 400. All other parameters and initial conditions kept as described in Figure \ref{metzlerian_growth-timeseries1}}
    \label{metzlerian_growth-y4bifurcation}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/y5bifurcation}
    \caption{Bifurcation diagram varying $\dot Y_5$ between -400 and 400. All other parameters and initial conditions kept as described in Figure \ref{metzlerian_growth-timeseries1}}
    \label{metzlerian_growth-y5bifurcation}
\end{figure}

Figure \ref{metzlerian_growth-y4bifurcation} displays fixed behavior when $\dot Y_4$ is very large or small compared to the other initial variables. When their values are more moderate, the long-run behavior of the model can be a 2-cycle such as when $\dot Y_4\in(-144.054, -111.571)$ or $\dot Y_4\in(87.880, 143.494)$. Higher order cycles and chaotic behavior is also present in this moderate range.


Figure \ref{metzlerian_growth-y5bifurcation} also displays fixed behavior when $\dot Y_5$ is very large or small compared to the other initial variables. 2-cycles are present when $\dot Y_5\in(-28.843, 27.243)\cup(71.167, 179.899)$ although chaotic behavior and higher order cycles are also present.

\section{Chaotic Behavior in Growth}
Bifurcation analysis of this type allows us to numerically determine the presence and location of bifurcation points separating arbitrary period cycles. However, this is insufficient to determining if varying the parameters of the model result in chaotic behavior and where exactly this transition occurs. The existence of chaos lends credence to the assumption of bounded rationality assigned to firms. If the model always features stable cycles, then it would only be logical that firms would eventually be able to adapt their predictive mechanism to predict this ordered behavior. The effect this shift in expectation rule would have on future dynamics is beyond the scope of this paper but could be performed by removing the Lundberg lag after the system has evolved over time.  the presence of chaos means the model is sufficiently sensitive to initial conditions that firms would not be able to accurately determine the future state of the market as under a chaotic system, knowing the approximate current state of the economy does not inform firms of the approximate future state of the economy. 

The method described in the introduction to solve for the Lyapunov exponent is applicable to 1-dimensional systems. Although our system is formally a 1-dimensional, 6th order difference equation, existing methods of analysis are much more accommodating to single-order mappings. We thus begin by rewriting the model as a 1st-order difference equation with 6 variables. This can be done by creating and defining the variables $\dot Y_{t-1}=\dot A_t$, $\dot A_{t-1}=\dot B_{t}$, $\dot B_{t-1}=\dot C_{t}$, $\dot C_{t-1}=\dot D_{t}$, and $\dot D_{t-1}=\dot G_{t}$. This allows us to define an equivalent model:
\begin{align*}
    \dot Y_t = f(\dot Y_{t-1}, \dot A_{t-1}, \dot B_{t-1}, \dot C_{t-1}, \dot D_{t-1}, \dot G_{t-1})\\
    \dot A_t = g(\dot Y_{t-1}, \dot A_{t-1}, \dot B_{t-1}, \dot C_{t-1}, \dot D_{t-1}, \dot G_{t-1})\\
    \dot B_t = h(\dot Y_{t-1}, \dot A_{t-1}, \dot B_{t-1}, \dot C_{t-1}, \dot D_{t-1}, \dot G_{t-1})\\
    \dot C_t = j(\dot Y_{t-1}, \dot A_{t-1}, \dot B_{t-1}, \dot C_{t-1}, \dot D_{t-1}, \dot G_{t-1})\\
    \dot D_t = l(\dot Y_{t-1}, \dot A_{t-1}, \dot B_{t-1}, \dot C_{t-1}, \dot D_{t-1}, \dot G_{t-1})\\
    \dot G_t = m(\dot Y_{t-1}, \dot A_{t-1}, \dot B_{t-1}, \dot C_{t-1}, \dot D_{t-1}, \dot G_{t-1})
\end{align*}
The Jacobian matrix of this system of equations is:
\begin{equation*}
J = \begin{bmatrix}
    \frac{\partial f}{\partial \dot Y_{t-1}} & \frac{\partial f}{\partial \dot A_{t-1}} & \frac{\partial f}{\partial \dot B_{t-1}} & \frac{\partial f}{\partial \dot C_{t-1}} & \frac{\partial f}{\partial \dot D_{t-1}} & \frac{\ f}{\partial \dot G_{t-1}}\\
    \frac{\partial g}{\partial \dot Y_{t-1}} & \frac{\partial g}{\partial \dot A_{t-1}} & \frac{\partial g}{\partial \dot B_{t-1}} & \frac{\partial g}{\partial \dot C_{t-1}} & \frac{\partial g}{\partial \dot D_{t-1}} & \frac{\ f}{\partial \dot G_{t-1}}\\
    \frac{\partial h}{\partial \dot Y_{t-1}} & \frac{\partial h}{\partial \dot A_{t-1}} & \frac{\partial h}{\partial \dot B_{t-1}} & \frac{\partial h}{\partial \dot C_{t-1}} & \frac{\partial h}{\partial \dot D_{t-1}} & \frac{\ f}{\partial \dot G_{t-1}}\\
    \frac{\partial j}{\partial \dot Y_{t-1}} & \frac{\partial j}{\partial \dot A_{t-1}} & \frac{\partial j}{\partial \dot B_{t-1}} & \frac{\partial j}{\partial \dot C_{t-1}} & \frac{\partial j}{\partial \dot D_{t-1}} & \frac{\ f}{\partial \dot G_{t-1}}\\
    \frac{\partial l}{\partial \dot Y_{t-1}} & \frac{\partial l}{\partial \dot A_{t-1}} & \frac{\partial l}{\partial \dot B_{t-1}} & \frac{\partial l}{\partial \dot C_{t-1}} & \frac{\partial l}{\partial \dot D_{t-1}} & \frac{\ f}{\partial \dot G_{t-1}}\\
    \frac{\partial m}{\partial \dot Y_{t-1}} & \frac{\partial m}{\partial \dot A_{t-1}} & \frac{\partial m}{\partial \dot B_{t-1}} & \frac{\partial m}{\partial \dot C_{t-1}} & \frac{\partial m}{\partial \dot D_{t-1}} & \frac{\ f}{\partial \dot G_{t-1}}
\end{bmatrix}
\label{eq:Jacobian}
\end{equation*}
\begin{equation}
J=
\begin{bmatrix}\small
    \frac{\partial f}{\partial Y_{t-1}} & \frac{\partial f}{\partial A_{t-1}} & s+\frac{k+1}{3}s & 0 & \frac{(k+1)(s-1)}{3} & -\frac{(k+1)s}{3}\\
    1 & 0 & 0 & 0 & 0 & 0\\
    0 & 1 & 0 & 0 & 0 & 0\\
    0 & 0 & 1 & 0 & 0 & 0\\
    0 & 0 & 0 & 1 & 0 & 0\\
    0 & 0 & 0 & 0 & 1 & 0
\end{bmatrix}
\end{equation}
where 
\begin{align*}
    \frac{\partial f}{\partial \dot Y_{t-1}}&= \frac{1}{v\left(q+\frac{Y_{t-1}^4}{v^4}\right)}-\frac{4Y_{t-1}^4}{v^5\left(q+\frac{Y_{t-1}^4}{v^4}\right)}\\
    \frac{\partial f}{\partial \dot A_{t-1}}&=1+\frac{1}{3}(k+1)(1-s)-s+\frac{4A_{t-1}^4}{v^5\left(q+\frac{A_{t-1}^4}{v^4}\right)^2}-\frac{1}{v\left(q+\frac{A_{t-1}^4}{v^4}\right)}
\end{align*}

Figure \ref{metzlerian_growth-derivative1} and \ref{metzlerian_growth-derivative2} displays the possible values for the variable partial derivatives of the model over a reasonable range of growth rates. All other partial derivatives present in the Jacobian are clearly constant given a set of parameters.

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/derivative1.eps}
    \caption{Plot of $\frac{\partial f}{\partial \dot Y_{t-1}}$ with respect to $\dot Y_{t-1}$.}
    \label{metzlerian_growth-derivative1}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/derivative2.eps}
    \caption{Plot of $\frac{\partial f}{\partial \dot A_{t-1}}$ with respect to $\dot A_{t-1}=\dot Y_{t-2}$.}
    \label{metzlerian_growth-derivative2}
\end{figure}

If we think of the our mapping as a transformation in an $n$-dimensional space and the Lyapunov exponent as a measure of the compression and expansion of this space, it is clear that we must track the direction of this action as the transformation iterates through time. This is accomplished by evaluating the evolution of an $n$-length vector $v$, normalized to a length of 1 for simplicity as the direction of this vector is all we are concerned with. This occurs with the 1-dimensional $v_t$ case as well, by incorporating a 1-dimensional vector of length 1. This is however, equivalent to the scalar 1 so it need not be explicitly included in calculation. The Jacobian $J$ operates as the higher-dimension analogue to the derivative so by taking the product of the Jacobian and the direction vector, we are able to project our derivatives onto the direction vector. From here, we can solve for the Lyapunov exponent much like in our 1-dimensional case:
\begin{equation}
    \lambda(\dot Y,\dot A,\dot B\dot C,\dot D,\dot G)= \lim_{j\to\infty}\frac{1}{j}\sum^{t=j}_{j=1}\ln\lvert J_t\cdot v_t\rvert
\end{equation}
With a 1-dimensional mapping, $v_t=v=1$ and $J_t=f^\prime(x_t)$. It is clear how the Jacobian evolves over timeas \ref{eq:Jacobian} is dependent on the state of the economy. The direction vector must also be updated, this is accomplished by normalizing the length of the projection:
\begin{equation}
    v_{t+1}=\frac{J_t\cdot v_t}{\lvert J_t\cdot v_t\rvert}
\end{equation}
A consequence of this is that the Lyapunov exponent is now both dependent on the initial condition and the choice of initial direction vector\autocite{MedioAlfredo2001Ndap,Puu2003}. As stated in the introduction, the initial condition provided it not reside in an unstable periodic cycle; moreover, the choice of initial vector is of little consequence as it quickly updates to the correct elongation direction regardless of initial choice. As stated for the 1-dimensional case, it is typically impractical to solve for the Lyapunov exponent analytically; however, we can approximate it by iterating the model for some large $t$ and treating this value as the limit.

An important note is that although 1-dimensional models only have 1 Lyapunov exponent, $n$ dimensional models actually have $n$ Lyapunov exponents.The method described above only calculates the largest exponent; however, it is typically only necessary to determine this maximal value as the positivity of this exponent is used as the determiner of chaos in the system. A consequence of the bounded behavior of our model is that the negative Lyapunov exponents must "dominate" in order to result in overall compression of the model; otherwise the mapping would result in an explosive model. 

\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/slyplot.eps}
    \caption{Lyapunov plot varying $s$ between 0 and 1. Other parameters and initial conditions are held constant held constant as described in Figure \ref{metzlerian_growth-timeseries1}.}
    \label{metzlerian_growth-sLyapunov}
\end{figure}
\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/klyplot.eps}
    \caption{Lyapunov plot varying $k$ between 0 and 1. Other parameters and initial conditions are held constant held constant as described in Figure \ref{metzlerian_growth-timeseries1}}
    \label{metzlerian_growth-kLyapunov}
\end{figure}
\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/vlyplot.eps}
    \caption{Lyapunov plot varying $v$ between 1 and 2000. Other parameters and initial conditions are held constant held constant as described in Figure \ref{metzlerian_growth-timeseries1}}
    \label{metzlerian_growth-vLyapunov}
\end{figure}
\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/qlyplot.eps}
    \caption{Lyapunov plot varying $q$ between 0 and 0.002. Other parameters and initial conditions are held constant held constant as described in Figure \ref{metzlerian_growth-timeseries1}}
    \label{metzlerian_growth-qLyapunov}
\end{figure}

Note again that we are calculating only the maximal Lyapunov exponent, thus if the displayed Lyapunov exponent is 0, the other exponents may be 0 or even negative meaning that there can be compression of the space occurring even when $\lambda=0$. Comparing the Lyapunov plot to the bifurcation diagrams for each parameter, we can clearly see that the parameter ranges where the Lyapunov exponent is positive correspond to dense regions in the bifurcation diagram. This implies that parameter choices can result in chaotic behavior as opposed to just cycles of higher periodicity than what was displayed in the bifurcation diagram. The regions of chaotic behavior are unsurprising based on visual observation of the bifurcation diagrams aside from the $q$ parameter.
\begin{figure}
    \centering
    \includegraphics[height=0.4\textheight]{./metzlerian_growth/q2bifurcation.eps}
    \caption{Bifurcation diagram varying $q$ between 0.0001 and 0.002. All other parameters and initial conditions kept as described in Figure \ref{metzlerian_growth-timeseries1}}
    \label{metzlerian_growth-qbifurcation_zoom}
\end{figure}
Figure \ref{metzlerian_growth-qbifurcation_zoom} is created identically to Figure \ref{metzlerian_growth-qbifurcation} but by excluding the smallest values for $q$ allows us to generate a much more accurate picture of the dynamics of the model as $q$ varies. Here it is obvious why the Lyapunov exponent plot indicated the presence of chaos until $q$ entering a region of stable cycles at $q>\num{0.889d-3}$.











